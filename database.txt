CREATE TABLE USER_TYPE
(
	ID SMALLINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	NAME VARCHAR(255) NOT NULL
);

CREATE TABLE USER_STATUS
(
	ID SMALLINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	NAME VARCHAR(255) NOT NULL
);

CREATE TABLE CATHEGORY
(
	ID SMALLINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	NAME VARCHAR(255) NOT NULL
);

CREATE TABLE PRODUCT
(
	ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	NAME VARCHAR(255) NOT NULL,
	PRICE FLOAT NOT NULL,
	CATHEGORY_ID SMALLINT NOT NULL
);

ALTER TABLE PRODUCT
ADD CONSTRAINT PRODUCT_ID_CATHEGORY
foreign key(CATHEGORY_ID) REFERENCES CATHEGORY(ID) ON DELETE CASCADE;


CREATE TABLE USER
(
	ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ADDRESS VARCHAR(255) NOT NULL,
	LOGIN VARCHAR(255) NOT NULL,
	PASSWORD VARCHAR(255) NOT NULL,
	NAME VARCHAR(255) NOT NULL,
	SURNAME VARCHAR(255) NOT NULL,
	EMAIL VARCHAR(255) NOT NULL,
	USER_TYPE_ID SMALLINT NOT NULL,
	USER_STATUS_ID SMALLINT NOT NULL DEFAULT 1
);

ALTER TABLE USER
ADD CONSTRAINT USER_ID_USER_TYPE
foreign key(USER_TYPE_ID) REFERENCES  USER_TYPE(ID) ON DELETE CASCADE;

ALTER TABLE USER
ADD CONSTRAINT USER_ID_USER_STATUS
foreign key(USER_STATUS_ID) REFERENCES  USER_STATUS(ID) ON DELETE CASCADE;

CREATE TABLE PURCHASE
(
	ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	USER_ID BIGINT NOT NULL,
	ACCEPTANCE_DATE TIMESTAMP NULL
);

ALTER TABLE PURCHASE
ADD CONSTRAINT PURCHASE_ID_USER
foreign key(USER_ID) REFERENCES  USER(ID) ON DELETE CASCADE;

CREATE TABLE PURCHASE_PRODUCT
(
	ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	PURCHASE_ID BIGINT NOT NULL,
	PRODUCT_ID BIGINT NOT NULL,
	QUANTITY BIGINT NOT NULL
);

ALTER TABLE PURCHASE_PRODUCT
ADD CONSTRAINT PURCHASE_PRODUCT_ID_PRODUCT
foreign key(PRODUCT_ID) REFERENCES  PRODUCT(ID) ON DELETE CASCADE;

ALTER TABLE PURCHASE_PRODUCT
ADD CONSTRAINT PURCHASE_PRODUCT_ID_PURCHASE
foreign key(PURCHASE_ID) REFERENCES  PURCHASE(ID) ON DELETE CASCADE;